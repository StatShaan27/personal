<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Assignment: Week-2 | Shaan</title>
  <link rel="stylesheet" href="../style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Inter:wght@300;500&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #121212;
      color: #e0e0e0;
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
    }

    h1, h2, h3, h4 {
      font-family: 'Playfair Display', serif;
      color: #6effe0;
    }

    header {
      text-align: center;
      padding: 2rem 1rem 1rem;
      background: #1e1e1e;
      border-bottom: 2px solid #333;
    }

    header nav ul {
      list-style: none;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 1rem;
      padding: 0;
    }

    header nav ul li {
      display: inline;
    }

    header nav ul li a {
      text-decoration: none;
      color: #6effe0;
      font-weight: 500;
      border: 1px solid transparent;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      transition: all 0.3s ease;
    }

    header nav ul li a:hover {
      border-color: #6effe0;
      background-color: #6effe0;
      color: #000;
    }

    .notes-wrapper {
      max-width: 900px;
      margin: 3rem auto;
      padding: 2rem;
      animation: fadeIn 1.2s ease;
    }

    .info-block {
      margin-bottom: 2rem;
      text-align: left;
      line-height: 1.6;
    }

    .info-block strong {
      color: #6effe0;
    }

    .toc {
      background-color: #1e1e1e;
      border-left: 4px solid #6effe0;
      padding: 1rem 1.5rem;
      margin-bottom: 2rem;
      border-radius: 8px;
    }

    .toc ul {
      padding-left: 1rem;
    }

    .toc ul li {
      padding: 0.3rem 0;
    }

    .toc a {
      color: #c9d1d9;
      text-decoration: none;
      border-bottom: 1px dashed #6effe0;
    }

    .toc a:hover {
      color: #6effe0;
    }

    .glow-box {
      border: 2px solid #6effe0;
      box-shadow: 0 0 20px rgba(110, 255, 224, 0.2);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      background-color: #1e1e1e;
      animation: pulse 3s infinite ease-in-out;
    }

    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 20px rgba(110, 255, 224, 0.2); }
      50% { box-shadow: 0 0 35px rgba(110, 255, 224, 0.4); }
    }

    ul {
      line-height: 1.6;
      padding-left: 1.2rem;
    }

    code, pre {
      background-color: #222;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-family: monospace;
      color: #6effe0;
      display: block;
      overflow-x: auto;
    }

    .next-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #6effe0;
      color: #000;
      padding: 0.6rem 1.2rem;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 0 10px #6effe0;
      transition: background-color 0.3s ease;
      z-index: 100;
    }

    .next-btn:hover {
      background-color: #00ffcc;
    }

    footer {
      text-align: center;
      font-size: 0.9rem;
      color: #888;
      padding: 2rem 1rem;
    }
  </style>
  <script type="text/javascript" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

</head>
<body>

<header>
  <h1>Statistical Methods III: Assignment Week-2</h1>
  <p>AY 2025–26</p>
  <nav>
    <ul>
      <li><a href="../../index.html">Home</a></li>
      <li><a href="../../assets/Shaan_CV.pdf">CV</a></li>
      <li><a href="../../sections/projects.html">Projects</a></li>
      <li><a href="../../sections/education.html">Education</a></li>
      <li><a href="../../sections/misc.html">Misc</a></li>
    </ul>
  </nav>
</header>

<section class="notes-wrapper">

  <div class="info-block">
    <p><strong>Instructor:</strong> Debasis Sengupta </p>
    <p><strong>Office / Department:</strong> ASU</p>
    <p><strong>Email:</strong> sdebasis@isical.ac.in</p>
    <p><strong>Marking Scheme:</strong><br>
      Assignments: 20% | Midterm Test: 30% | End Semester: 50%
    </p>
  </div>

  <div class="toc">
    <h3>Contents</h3>
   <ul>
  <li><a href="#1">Question 1</a></li>
  <li><a href="#2">Question 2</a></li>
  <li><a href="#3">Question 3</a></li>
  <li><a href="#4">Question 4</a></li>
  <li><a href="#5">Question 5</a></li>
  <li><a href="#6">Question 6</a></li>
  <li><a href="#7">Question 7</a></li>
  <li><a href="#8">Question 8</a></li>
  <li><a href="#9">Question 9</a></li>
  <li><a href="#10">Question 10</a></li>
</ul>
  </div>

  <!-- Notes section boxes -->
  <div class="glow-box" id="1">
   
<section>
  <h2>Question</h2>
  <p>
    <strong>Q1.</strong><br>
    Let \(X_1,X_2,\dots,X_n\) be the numbers of annual accidents occurring in \(n\) stretches of a highway in year 2010. These are independent with pmf \(\mathrm{Poi}(\tau_i),\; i=1,\dots,n.\)
    Let \(Y_1,Y_2,\dots,Y_n\) be the numbers of annual accidents on the same stretches in year 2020; they are independent with pmf \(\mathrm{Poi}(\beta\tau_i),\; i=1,\dots,n.\)
    For some reason observations \(X_1,\dots,X_k\) are missing (only \(X_{k+1},\dots,X_n\) are observed). Derive explicit expressions for the MLE of \(\beta\) and \(\tau_1,\dots,\tau_n.\)
  </p>

  <h2>Solution</h2>
  <ul>
    <li>
      <strong>Step 0 — notation.</strong>
      <ul>
        <li>Define the indicator \(\delta_i\) for observed \(X_i\):
          \[
            \delta_i=\begin{cases}1,& i=k+1,\dots,n\ (\text{observed }X_i),\\[4pt]
            0,& i=1,\dots,k\ (\text{missing }X_i).\end{cases}
          \]
        </li>
        <li>Observed-data totals:
          \[
            S_X=\sum_{i:\,\delta_i=1} X_i=\sum_{i=k+1}^n X_i,\qquad S_Y=\sum_{i=1}^n Y_i.
          \]
        </li>
      </ul>
    </li>

    <li>
      <strong>Step 1 — observed-data likelihood.</strong>
      <ul>
        <li>The observed-data likelihood (up to constants not involving parameters) is
          \[
            L(\beta,\tau_1,\dots,\tau_n)
            \propto
            \prod_{i:\,\delta_i=1} e^{-\tau_i}\tau_i^{X_i}\times
            \prod_{i=1}^n e^{-\beta\tau_i}(\beta\tau_i)^{Y_i}.
          \]
        </li>
        <li>Log-likelihood \(\ell(\beta,\tau)\):
          \[
            \ell(\beta,\tau)
            = \sum_{i:\,\delta_i=1}\big[-\tau_i+X_i\log\tau_i\big]
            + \sum_{i=1}^n\big[-\beta\tau_i + Y_i\log\beta + Y_i\log\tau_i\big]
            + \text{const.}
          \]
        </li>
      </ul>
    </li>

    <li>
      <strong>Step 2 — score equations for each \(\tau_i\).</strong>
      <ul>
        <li>If \(X_i\) is observed (\(\delta_i=1\)):
          \[
            \frac{\partial\ell}{\partial\tau_i}
            = -1 + \frac{X_i}{\tau_i} -\beta + \frac{Y_i}{\tau_i}
            = -(1+\beta)+\frac{X_i+Y_i}{\tau_i}.
          \]
          Setting to \(0\) gives
          \[
            \tau_i=\frac{X_i+Y_i}{1+\beta},\qquad i=k+1,\dots,n.
          \]
        </li>
        <li>If \(X_i\) is missing (\(\delta_i=0\)):
          \[
            \frac{\partial\ell}{\partial\tau_i}
            = -(1+\beta)+\frac{Y_i}{\tau_i}=0
            \quad\Rightarrow\quad
            \tau_i=\frac{Y_i}{1+\beta},\qquad i=1,\dots,k.
          \]
        </li>
        <li>Compact form (solution of \(\tau_i\)-score eqns as a function of \(\beta\)):
          \[
            \boxed{\;\hat\tau_i(\beta)=\frac{\delta_i X_i + Y_i}{1+\beta}\;,\qquad i=1,\dots,n.\;}
          \]
        </li>
      </ul>
    </li>

    <li>
      <strong>Step 3 — score equation for \(\beta\).</strong>
      <ul>
        <li>Differentiate \(\ell\) w.r.t. \(\beta\):
          \[
            \frac{\partial\ell}{\partial\beta}
            = \sum_{i=1}^n\left(-\tau_i + \frac{Y_i}{\beta}\right)
            = -\sum_{i=1}^n \tau_i + \frac{S_Y}{\beta}.
          \]
        </li>
        <li>Substitute \(\tau_i=\hat\tau_i(\beta)=\dfrac{\delta_i X_i+Y_i}{1+\beta}\) to get
          \[
            -\sum_{i=1}^n \frac{\delta_i X_i + Y_i}{1+\beta} + \frac{S_Y}{\beta} = 0.
          \]
          Since \(\sum_{i=1}^n(\delta_i X_i+Y_i)=S_X+S_Y\), this simplifies to
          \[
            -\frac{S_X+S_Y}{1+\beta} + \frac{S_Y}{\beta}=0.
          \]
        </li>
        <li>Solve for \(\beta\):
          \[
            \frac{S_Y}{\beta}=\frac{S_X+S_Y}{1+\beta}
            \quad\Longrightarrow\quad
            \beta(S_X+S_Y)=S_Y(1+\beta)
            \quad\Longrightarrow\quad
            \beta S_X=S_Y.
          \]
          Hence, provided \(S_X>0\),
          \[
            \boxed{\;\hat\beta=\frac{S_Y}{S_X}=\frac{\sum_{i=1}^n Y_i}{\sum_{i=k+1}^n X_i}\;. \;}
          \]
        </li>
      </ul>
    </li>

    <li>
      <strong>Step 4 — plug back to get \(\hat\tau_i\).</strong>
      <ul>
        <li>Using \(\hat\beta=S_Y/S_X\) in \(\hat\tau_i(\beta)\) yields
          \[
            \boxed{\;\hat\tau_i
            = \frac{\delta_i X_i + Y_i}{1+\hat\beta}
            = \frac{\delta_i X_i + Y_i}{1 + \dfrac{S_Y}{S_X}}
            = \frac{S_X(\delta_i X_i + Y_i)}{S_X+S_Y}\;. \;}
          \]
        </li>
        <li>Equivalently,
          \[
            \hat\tau_i=\begin{cases}
              \dfrac{X_i+Y_i}{1+\hat\beta}, & i=k+1,\dots,n\ (\text{observed }X_i),\\[8pt]
              \dfrac{Y_i}{1+\hat\beta}, & i=1,\dots,k\ (\text{missing }X_i).
            \end{cases}
          \]
        </li>
      </ul>
    </li>

    <li>
      <strong>Step 5 — existence / edge cases.</strong>
      <ul>
        <li>If \(S_X=\sum_{i=k+1}^n X_i=0\) while \(S_Y>0\), the equation \(\beta S_X=S_Y\) cannot be satisfied by any finite \(\beta\); the likelihood increases as \(\beta\to\infty\) and no finite MLE exists.</li>
        <li>If \(S_X=0\) and \(S_Y=0\), \(\beta\) is not identifiable (any \(\beta\) gives same likelihood) and all \(\tau_i\) are estimated as zero. Assume \(S_X>0\) for the usual case.</li>
      </ul>
    </li>

    <li>
      <strong>Step 6 — justification of maximum.</strong>
      <ul>
        <li>For fixed \(\beta\) the log-likelihood is concave in each \(\tau_i\) (second derivative w.r.t. \(\tau_i\) equals \(- (X_i+Y_i)/\tau_i^2<0\) when \(X_i+Y_i>0\)), and profiling yields a single finite critical point for \(\beta\) under regular data (\(S_X>0\)), giving the global maximum in regular cases.</li>
      </ul>
    </li>
  </ul>

  <h2>Related concepts</h2>
  <ul>
    <li><strong>Poisson-regression / GLM viewpoint:</strong> the model is a multiplicative scale-change; \(\log\beta\) acts like an offset if \(\tau_i\) were modeled.</li>
    <li><strong>Profile likelihood:</strong> we profiled out the \(\tau_i\) to obtain a closed-form MLE for \(\beta\).</li>
    <li><strong>Method-of-moments equivalence:</strong> \(\hat\beta=S_Y/S_X\) also follows from equating totals, since \(E[S_Y]=\beta E[S_X]\).</li>
    <li><strong>Missingness assumption:</strong> we implicitly assumed the \(X\)-missingness is non-informative (MCAR). If missingness depends on \(\tau_i\) or \(Y_i\), estimates may be biased.</li>
  </ul>

  <h2>Remarks / Summary</h2>
  <p>
    The MLEs are simple and intuitive:
    \[
      \boxed{\;\hat\beta=\frac{S_Y}{S_X}\;,\qquad
      \hat\tau_i=\frac{\delta_i X_i + Y_i}{1+\hat\beta}=\frac{S_X(\delta_i X_i + Y_i)}{S_X+S_Y}\;}
    \]
    (with the usual caveat that \(S_X>0\) is required for a finite \(\hat\beta\)). These estimators borrow strength across stretches and years: missing \(X_i\) are estimated using \(Y_i\) and the global scale \(\hat\beta\).
  </p>
  
</section>


  </div>












    <div class="glow-box" id="2">
      <h2>Q2.</h2>
<p>
In Problem 1, assume a “complete data model” that includes the observed values of \(X_1,\dots,X_k\) (so the missing \(X_1,\dots,X_k\) are treated as latent). Write down the E-step and the M-step of the EM algorithm to obtain the MLEs of \(\beta\) and \(\tau_1,\dots,\tau_n\).
</p>

<h2>Solution</h2>

<h2>Model recap / notation</h2>
<ul>
    <li>For \(i=1,\dots,n\):
        <ul>
            <li>\(X_i \sim \operatorname{Poi}(\tau_i)\)</li>
            <li>\(Y_i \sim \operatorname{Poi}(\beta\tau_i)\)</li>
        </ul>
        Independent across \(i\) and between years conditional on the \(\tau_i\)’s.
    </li>
    <li>Observed: all \(Y_i\); \(X_{k+1},\dots,X_n\) observed; \(X_1,\dots,X_k\) missing.</li>
    <li>Sets: \(M=\{1,\dots,k\}\) (missing), \(O=\{k+1,\dots,n\}\) (observed).</li>
    <li>Notation:
        \[
        S_X^{(O)}=\sum_{i\in O} X_i,\quad
        S_Y=\sum_{i=1}^n Y_i,\quad
        S_Y^{(O)}=\sum_{i\in O} Y_i,\quad
        S_Y^{(M)}=\sum_{i\in M} Y_i
        \]
    </li>
</ul>

<h2>Complete-data log-likelihood</h2>
<p>If we had the full data \((X_1,\dots,X_n,Y_1,\dots,Y_n)\), the log-likelihood (up to constant) is:</p>
\[
\ell_c(\beta,\tau)
= \sum_{i=1}^n\left[-(1+\beta)\tau_i + (X_i+Y_i)\log\tau_i\right] + S_Y\log\beta
\]

<h2>E-step</h2>
<ul>
    <li>For each missing \(i\in M\):
        \[
        \mathbb{E}[X_i\mid Y_i,\theta^{(t)}] = \tau_i^{(t)}
        \]
        (since \(X_i\) and \(Y_i\) are independent given \(\tau_i\)).
    </li>
    <li>Define:
        \[
        \tilde X_i^{(t)} =
        \begin{cases}
        X_i, & i\in O,\\
        \tau_i^{(t)}, & i\in M.
        \end{cases}
        \]
    </li>
    <li>Expected complete-data log-likelihood:
        \[
        Q(\beta,\tau\mid\theta^{(t)}) = \sum_{i=1}^n\left[-(1+\beta)\tau_i + (\tilde X_i^{(t)}+Y_i)\log\tau_i\right] + S_Y\log\beta
        \]
    </li>
</ul>

<h2>M-step</h2>
<ul>
    <li>Differentiate w.r.t. \(\tau_i\):
        \[
        \tau_i^{(t+1)} = \frac{\tilde X_i^{(t)} + Y_i}{1+\beta}
        \]
    </li>
    <li>Differentiate w.r.t. \(\beta\):
        \[
        \beta^{(t+1)} = \frac{S_Y}{\sum_{i=1}^n \tau_i^{(t+1)}}
        \]
    </li>
    <li>Substitute to obtain:
        \[
        \beta^{(t+1)} = \frac{S_Y}{S_X^{(O)} + \sum_{i\in M} \tau_i^{(t)}}
        \]
    </li>
</ul>

<h2>One EM iteration</h2>
<ul>
    <li><strong>E-step:</strong>
        <ul>
            <li>For \(i\in M\): \(\tilde X_i^{(t)} = \tau_i^{(t)}\)</li>
            <li>For \(i\in O\): \(\tilde X_i^{(t)} = X_i\)</li>
        </ul>
    </li>
    <li><strong>M-step:</strong>
        <ol>
            <li>\(\displaystyle \beta^{(t+1)} = \frac{S_Y}{S_X^{(O)} + \sum_{i\in M} \tau_i^{(t)}}\)</li>
            <li>\(\displaystyle \tau_i^{(t+1)} = \frac{\tilde X_i^{(t)} + Y_i}{1+\beta^{(t+1)}}\)</li>
        </ol>
    </li>
</ul>

<h2>Initialization & termination</h2>
<ul>
    <li>Initialize \(\tau_i^{(0)}\) and \(\beta^{(0)}\) with reasonable values.</li>
    <li>Iterate until convergence based on parameter change or log-likelihood increment.</li>
</ul>

<h2>Fixed point / connection to MLE</h2>
<ul>
    <li>At convergence:
        \[
        \tau_i^{*} = \frac{\tilde X_i^{*}+Y_i}{1+\beta^{*}}, \quad
        \beta^{*} = \frac{S_Y}{\sum_i \tilde X_i^{*}}
        \]
    </li>
    <li>For \(i\in O\): \(\tau_i^{*} = \frac{X_i+Y_i}{1+\beta^{*}}\)</li>
    <li>For \(i\in M\): \(\tau_i^{*} = \frac{Y_i}{\beta^{*}}\)</li>
    <li>Final closed-form MLE:
        \[
        \beta^{*} = \frac{S_Y^{(O)}}{S_X^{(O)}}
        \]
    </li>
</ul>

<h2>Edge cases</h2>
<ul>
    <li>If \(S_X^{(O)}=0\), \(\beta\) not identifiable — regularize or use Bayesian approach.</li>
    <li>If \(S_Y^{(O)}=0\) and \(S_X^{(O)}>0\), \(\beta^{*}=0\).</li>
</ul>

    </div>






















  <div class="glow-box" id="3">
      
    </div>























  <div class="glow-box" id="4">
    
  </div>

























  <div class="glow-box" id="5">
      
  </div>
























<div class="glow-box" id="6">
      
</div>






























  <div class="glow-box" id="7">
      
  </div>






























  <div class="glow-box" id="8">
      
  </div>




























  <div class="glow-box" id="9">
      
  </div>










  




















  <div class="glow-box" id="10">
      
  </div>

</section>

<button class="next-btn" onclick="location.href='wk2.html'">Next Section →</button>

<footer>
  <p>&copy; 2025 Shaan | Built with purpose</p>
</footer>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)']],
    displayMath: [['\\[', '\\]']]
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>

</body>
</html>
